# ðŸ“ í™œë™ ë¡œê·¸ ì •ì±… ë° ê°€ì´ë“œ

**ìž‘ì„±ì¼**: 2025-10-26  
**ë²„ì „**: v1.0  
**ìƒíƒœ**: âœ… í•„ìˆ˜ ì¤€ìˆ˜ ì‚¬í•­

---

## ðŸŽ¯ ê¸°ë³¸ ì›ì¹™

### **ëª¨ë“  ë°ì´í„° ë³€ê²½ ìž‘ì—…ì€ í™œë™ ë¡œê·¸ì— ê¸°ë¡ë˜ì–´ì•¼ í•©ë‹ˆë‹¤!**

ì´ëŠ” ë‹¤ìŒì„ ìœ„í•´ í•„ìˆ˜ì ìž…ë‹ˆë‹¤:
- ðŸ“Š **ì¶”ì ì„±**: ëˆ„ê°€, ì–¸ì œ, ë¬´ì—‡ì„ ë³€ê²½í–ˆëŠ”ì§€ ì¶”ì 
- ðŸ” **ë””ë²„ê¹…**: ë¬¸ì œ ë°œìƒ ì‹œ ì›ì¸ íŒŒì•…
- ðŸ“ˆ **ë¶„ì„**: ì‚¬ìš© íŒ¨í„´ ë° í†µê³„ ë¶„ì„
- ðŸ” **ë³´ì•ˆ**: ë¹„ì •ìƒì ì¸ í™œë™ ê°ì§€
- ðŸ“œ **ê°ì‚¬**: ê·œì • ì¤€ìˆ˜ ë° ê°ì‚¬ ëŒ€ì‘

---

## ðŸ“‹ í™œë™ ë¡œê·¸ í•„ìˆ˜ ê¸°ë¡ ëŒ€ìƒ

### âœ… ë°˜ë“œì‹œ ê¸°ë¡í•´ì•¼ í•˜ëŠ” ìž‘ì—…

#### 1. **ê°€ê²Œ ê´€ë¦¬**
- [x] ê°€ê²Œ ìƒì„±
- [x] ê°€ê²Œ ì •ë³´ ìˆ˜ì • (ì´ë¦„, ì „í™”ë²ˆí˜¸, ì£¼ì†Œ)
- [x] ê°€ê²Œ ì‚­ì œ
- [x] ê°€ê²Œ ì„ íƒ/ì „í™˜
- [x] ê°€ê²Œ ì¼ì‹œì •ì§€
- [x] ê°€ê²Œ ìž¬ê°œ

#### 2. **ì„¤ì • ê´€ë¦¬**
- [x] ë°°ë‹¬ì•± URL ì„¤ì •/ìˆ˜ì •
- [x] ë°°ë‹¬ì•± ìˆœì„œ ë³€ê²½
- [x] í• ì¸ ì„¤ì • í™œì„±í™”/ë¹„í™œì„±í™”
- [x] í• ì¸ ë‚´ìš© ìˆ˜ì •
- [x] í”½ì—… ì•ˆë‚´ í™œì„±í™”/ë¹„í™œì„±í™”
- [x] í”½ì—… ë‚´ìš© ìˆ˜ì •
- [x] UI ì„¹ì…˜ ìˆœì„œ ë³€ê²½

#### 3. **ì´ë¯¸ì§€ ê´€ë¦¬**
- [x] ë¡œê³  ì´ë¯¸ì§€ ì—…ë¡œë“œ
- [x] ë©”ë‰´ ì´ë¯¸ì§€ ì—…ë¡œë“œ
- [x] ì´ë¯¸ì§€ ì‚­ì œ

#### 4. **QR ì½”ë“œ ê´€ë¦¬**
- [x] QR ì½”ë“œ ìƒì„±
- [x] QR ì½”ë“œ ìž¬ìƒì„±
- [x] QR ì½”ë“œ ë‹¤ìš´ë¡œë“œ
- [x] QR ì½”ë“œ ì‚­ì œ

#### 5. **ìŠˆí¼ì–´ë“œë¯¼**
- [x] ìŠˆí¼ì–´ë“œë¯¼ ë¡œê·¸ì¸
- [x] ìŠˆí¼ì–´ë“œë¯¼ ì •ë³´ ìˆ˜ì •

---

## ðŸ“Š í™œë™ ë¡œê·¸ ë°ì´í„° êµ¬ì¡°

### ê¸°ë³¸ êµ¬ì¡°
```json
{
  "id": "uuid",
  "timestamp": "2025-10-26T15:45:00.123456",
  "type": "store|settings|image|qr|admin",
  "action": "ìƒì„±|ìˆ˜ì •|ì‚­ì œ|ì—…ë¡œë“œ|ë‹¤ìš´ë¡œë“œ|í™œì„±í™”|ë¹„í™œì„±í™”",
  "description": "ìƒì„¸ ì„¤ëª… (ë³€ê²½ ì „/í›„ í¬í•¨)",
  "userId": "admin",
  "userName": "ê´€ë¦¬ìž",
  "targetType": "store|setting|image|qr",
  "targetId": "store_xxx|setting_xxx",
  "targetName": "ê°€ê²Œëª…|ì„¤ì •ëª…",
  "details": {
    "oldValue": "ë³€ê²½ ì „ ê°’",
    "newValue": "ë³€ê²½ í›„ ê°’",
    "additionalInfo": {}
  }
}
```

### í•„ìˆ˜ í•„ë“œ
- `type`: í™œë™ ìœ í˜•
- `action`: ìˆ˜í–‰í•œ ìž‘ì—…
- `description`: ì‚¬ëžŒì´ ì½ì„ ìˆ˜ ìžˆëŠ” ì„¤ëª…
- `timestamp`: ë°œìƒ ì‹œê°

### ê¶Œìž¥ í•„ë“œ
- `details.oldValue`: ë³€ê²½ ì „ ê°’
- `details.newValue`: ë³€ê²½ í›„ ê°’
- `targetId`: ëŒ€ìƒ ê°ì²´ ID
- `targetName`: ëŒ€ìƒ ê°ì²´ ì´ë¦„

---

## ðŸ” í™œë™ ë¡œê·¸ ìƒì„¸ ìž‘ì„± ê°€ì´ë“œ

### 1. **ê°€ê²Œ ìƒì„±**
```javascript
await logActivity('store', 'ê°€ê²Œ ìƒì„±', 
  `ìƒˆë¡œìš´ ê°€ê²Œ '${storeName}'ì„ ìƒì„±í–ˆìŠµë‹ˆë‹¤.`, {
    storeId: newStore.id,
    storeName: storeName,
    phone: phone,
    address: address,
    createdAt: newStore.createdAt
});
```

### 2. **ê°€ê²Œ ì •ë³´ ìˆ˜ì •**
```javascript
await logActivity('store', 'ê°€ê²Œ ì •ë³´ ìˆ˜ì •', 
  `'${storeName}' ê°€ê²Œì˜ ê¸°ë³¸ ì •ë³´ë¥¼ ìˆ˜ì •í–ˆìŠµë‹ˆë‹¤.\në³€ê²½ í•­ëª©: ${changedFields.join(', ')}`, {
    storeId: storeId,
    storeName: storeName,
    changes: {
      name: { old: oldName, new: newName },
      phone: { old: oldPhone, new: newPhone },
      address: { old: oldAddress, new: newAddress }
    }
});
```

### 3. **ë°°ë‹¬ì•± URL ì„¤ì •**
```javascript
await logActivity('settings', 'ë°°ë‹¬ì•± URL ì„¤ì •', 
  `${appName} URLì„ ${url ? 'ì„¤ì •' : 'ì œê±°'}í–ˆìŠµë‹ˆë‹¤.\nì´ì „: ${oldUrl || 'ì—†ìŒ'}\nì´í›„: ${url || 'ì—†ìŒ'}`, {
    storeId: storeId,
    appName: appName,
    oldUrl: oldUrl,
    newUrl: url
});
```

### 4. **ë°°ë‹¬ì•± ìˆœì„œ ë³€ê²½**
```javascript
await logActivity('settings', 'ë°°ë‹¬ì•± ìˆœì„œ ë³€ê²½', 
  `ë°°ë‹¬ì•± í‘œì‹œ ìˆœì„œ ë³€ê²½\nì´ì „: ${oldOrderNames}\nì´í›„: ${newOrderNames}`, {
    storeId: storeId,
    oldOrder: oldOrder,
    newOrder: newOrder,
    oldOrderNames: oldOrderNames,
    newOrderNames: newOrderNames
});
```

### 5. **í• ì¸ ì„¤ì •**
```javascript
await logActivity('settings', 'í• ì¸ ì„¤ì • ë³€ê²½', 
  `í• ì¸ ì„¤ì •ì„ ${enabled ? 'í™œì„±í™”' : 'ë¹„í™œì„±í™”'}í–ˆìŠµë‹ˆë‹¤.\nì œëª©: ${title}\në‚´ìš©: ${description}`, {
    storeId: storeId,
    enabled: enabled,
    title: title,
    description: description,
    oldEnabled: oldEnabled
});
```

### 6. **í”½ì—… ì•ˆë‚´ ì„¤ì •**
```javascript
await logActivity('settings', 'í”½ì—… ì•ˆë‚´ ë³€ê²½', 
  `í”½ì—… ì•ˆë‚´ë¥¼ ${enabled ? 'í™œì„±í™”' : 'ë¹„í™œì„±í™”'}í–ˆìŠµë‹ˆë‹¤.\nì œëª©: ${title}\në‚´ìš©: ${description}`, {
    storeId: storeId,
    enabled: enabled,
    title: title,
    description: description,
    oldEnabled: oldEnabled
});
```

### 7. **UI ì„¹ì…˜ ìˆœì„œ ë³€ê²½**
```javascript
await logActivity('settings', 'UI ìˆœì„œ ë³€ê²½', 
  `ê°€ê²Œ íŽ˜ì´ì§€ ì„¹ì…˜ ìˆœì„œ ë³€ê²½\nì´ì „: ${oldOrderTitles}\nì´í›„: ${newOrderTitles}`, {
    storeId: storeId,
    oldOrder: oldSectionOrder.map(s => s.id),
    newOrder: sectionOrder.map(s => s.id),
    oldOrderTitles: oldOrderTitles,
    newOrderTitles: newOrderTitles
});
```

### 8. **ì´ë¯¸ì§€ ì—…ë¡œë“œ**
```javascript
await logActivity('image', 'ì´ë¯¸ì§€ ì—…ë¡œë“œ', 
  `${imageType === 'mainLogo' ? 'ë©”ì¸ ë¡œê³ ' : 'ë©”ë‰´ ì´ë¯¸ì§€'}ë¥¼ ì—…ë¡œë“œí–ˆìŠµë‹ˆë‹¤.\níŒŒì¼ëª…: ${filename}\ní¬ê¸°: ${fileSize}`, {
    storeId: storeId,
    imageType: imageType,
    filename: filename,
    fileSize: fileSize,
    uploadPath: uploadPath
});
```

### 9. **QR ì½”ë“œ ìƒì„±**
```javascript
await logActivity('qr', 'QR ì½”ë“œ ìƒì„±', 
  `QR ì½”ë“œê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤. (ê°€ê²Œë³„ ê³ ìœ  URL í¬í•¨)\nëŒ€ìƒ URL: ${targetUrl}\në¡œê³  í¬í•¨: ${hasLogo ? 'ì˜ˆ' : 'ì•„ë‹ˆì˜¤'}`, {
    storeId: storeId,
    qrCodeUrl: qrCodeUrl,
    targetUrl: targetUrl,
    hasLogo: hasLogo,
    logoPath: logoPath
});
```

### 10. **QR ì½”ë“œ ì‚­ì œ**
```javascript
await logActivity('qr', 'QR ì½”ë“œ ì‚­ì œ', 
  `QR ì½”ë“œê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.\níŒŒì¼: ${filename}`, {
    storeId: storeId,
    deletedFile: filename,
    deletedAt: new Date().toISOString()
});
```

---

## ðŸš€ ë°±ì—”ë“œ í™œë™ ë¡œê·¸ êµ¬í˜„

### Python ì„œë²„ì—ì„œ í™œë™ ë¡œê·¸ ê¸°ë¡

```python
def log_activity(self, log_type, action, description, user_id="admin", 
                 user_name="ê´€ë¦¬ìž", target_type=None, target_id=None, 
                 target_name=None, details=None):
    """
    í™œë™ ë¡œê·¸ ê¸°ë¡
    
    Args:
        log_type: í™œë™ ìœ í˜• (store, settings, image, qr, admin)
        action: ìˆ˜í–‰í•œ ìž‘ì—…
        description: ìƒì„¸ ì„¤ëª…
        user_id: ì‚¬ìš©ìž ID
        user_name: ì‚¬ìš©ìž ì´ë¦„
        target_type: ëŒ€ìƒ ìœ í˜•
        target_id: ëŒ€ìƒ ID
        target_name: ëŒ€ìƒ ì´ë¦„
        details: ì¶”ê°€ ìƒì„¸ ì •ë³´
    """
    try:
        data = self.load_data()
        
        if 'activityLogs' not in data:
            data['activityLogs'] = []
        
        new_log = {
            "id": str(uuid.uuid4()),
            "timestamp": datetime.now().isoformat(),
            "type": log_type,
            "action": action,
            "description": description,
            "userId": user_id,
            "userName": user_name,
            "targetType": target_type,
            "targetId": target_id,
            "targetName": target_name,
            "details": details or {}
        }
        
        data['activityLogs'].insert(0, new_log)
        
        # ìµœëŒ€ 1000ê°œê¹Œì§€ë§Œ ìœ ì§€
        if len(data['activityLogs']) > 1000:
            data['activityLogs'] = data['activityLogs'][:1000]
        
        self.save_data(data)
        log(LogLevel.INFO, f"í™œë™ ë¡œê·¸ ê¸°ë¡: {log_type} - {action}")
        
    except Exception as e:
        log_error(f"í™œë™ ë¡œê·¸ ê¸°ë¡ ì‹¤íŒ¨: {log_type} - {action}", e)
```

---

## ðŸ“± í”„ë¡ íŠ¸ì—”ë“œ í™œë™ ë¡œê·¸ êµ¬í˜„

### JavaScriptì—ì„œ í™œë™ ë¡œê·¸ ê¸°ë¡

```javascript
async function logActivity(type, action, description, details = {}) {
    const logData = {
        type: type,
        action: action,
        description: description,
        userId: 'admin',
        userName: 'ê´€ë¦¬ìž',
        timestamp: new Date().toISOString(),
        details: details
    };
    
    try {
        await apiRequest('/api/activity-logs', 'POST', logData);
    } catch (error) {
        console.error('í™œë™ ë¡œê·¸ ê¸°ë¡ ì‹¤íŒ¨:', error);
        
        // í´ë°±: localStorageì— ì €ìž¥
        const localLogs = JSON.parse(localStorage.getItem('activityLogs') || '[]');
        localLogs.unshift(logData);
        localStorage.setItem('activityLogs', JSON.stringify(localLogs.slice(0, 100)));
    }
}
```

---

## âœ… ì²´í¬ë¦¬ìŠ¤íŠ¸: ìƒˆ ê¸°ëŠ¥ êµ¬í˜„ ì‹œ

### ë°±ì—”ë“œ API êµ¬í˜„ ì‹œ
- [ ] API ì—”ë“œí¬ì¸íŠ¸ì— `self.log_activity()` í˜¸ì¶œ ì¶”ê°€
- [ ] ë³€ê²½ ì „/í›„ ê°’ì„ `details`ì— í¬í•¨
- [ ] `target_id`, `target_name` ëª…ì‹œ
- [ ] ì„±ê³µ ì‹œì—ë§Œ ë¡œê·¸ ê¸°ë¡

### í”„ë¡ íŠ¸ì—”ë“œ ê¸°ëŠ¥ êµ¬í˜„ ì‹œ
- [ ] ì‚¬ìš©ìž ì•¡ì…˜ í›„ `logActivity()` í˜¸ì¶œ
- [ ] ìƒì„¸í•œ `description` ìž‘ì„± (ë³€ê²½ ì „/í›„ í¬í•¨)
- [ ] `details` ê°ì²´ì— ê´€ë ¨ ì •ë³´ í¬í•¨
- [ ] ì—ëŸ¬ ë°œìƒ ì‹œì—ë„ ë¡œê·¸ ê¸°ë¡ (ì‹¤íŒ¨ ë¡œê·¸)

---

## ðŸ” í™œë™ ë¡œê·¸ ê²€ì¦

### ë¡œê·¸ê°€ ì œëŒ€ë¡œ ê¸°ë¡ë˜ì—ˆëŠ”ì§€ í™•ì¸

```bash
# ìµœê·¼ í™œë™ ë¡œê·¸ í™•ì¸
curl http://localhost:8081/api/activity-logs | jq '.logs[:5]'

# íŠ¹ì • íƒ€ìž… ë¡œê·¸ í™•ì¸
curl http://localhost:8081/api/activity-logs | jq '.logs[] | select(.type=="qr")'

# íŠ¹ì • ì•¡ì…˜ ë¡œê·¸ í™•ì¸
curl http://localhost:8081/api/activity-logs | jq '.logs[] | select(.action=="QR ì½”ë“œ ìƒì„±")'
```

---

## ðŸ“Š í™œë™ ë¡œê·¸ ì˜ˆì‹œ

### ì¢‹ì€ ì˜ˆì‹œ âœ…

```json
{
  "id": "abc123",
  "timestamp": "2025-10-26T15:45:00.123456",
  "type": "settings",
  "action": "ë°°ë‹¬ì•± ìˆœì„œ ë³€ê²½",
  "description": "ë°°ë‹¬ì•± í‘œì‹œ ìˆœì„œ ë³€ê²½\nì´ì „: ë•¡ê²¨ìš” â†’ ë°°ë‹¬ì˜ë¯¼ì¡± â†’ ì¿ íŒ¡ì´ì¸  â†’ ìš”ê¸°ìš”\nì´í›„: ë°°ë‹¬ì˜ë¯¼ì¡± â†’ ë•¡ê²¨ìš” â†’ ìš”ê¸°ìš” â†’ ì¿ íŒ¡ì´ì¸ ",
  "userId": "admin",
  "userName": "ê´€ë¦¬ìž",
  "targetType": "setting",
  "targetId": "store_123",
  "targetName": "ë¯¸ì¹œì œìœ¡",
  "details": {
    "oldOrder": ["ttaeng", "baemin", "coupang", "yogiyo"],
    "newOrder": ["baemin", "ttaeng", "yogiyo", "coupang"],
    "oldOrderNames": "ë•¡ê²¨ìš” â†’ ë°°ë‹¬ì˜ë¯¼ì¡± â†’ ì¿ íŒ¡ì´ì¸  â†’ ìš”ê¸°ìš”",
    "newOrderNames": "ë°°ë‹¬ì˜ë¯¼ì¡± â†’ ë•¡ê²¨ìš” â†’ ìš”ê¸°ìš” â†’ ì¿ íŒ¡ì´ì¸ "
  }
}
```

### ë‚˜ìœ ì˜ˆì‹œ âŒ

```json
{
  "type": "settings",
  "action": "ë³€ê²½",
  "description": "ì„¤ì • ë³€ê²½ë¨"
}
```

**ë¬¸ì œì **:
- ë³€ê²½ ì „/í›„ ê°’ ì—†ìŒ
- ë¬´ì—‡ì´ ë³€ê²½ë˜ì—ˆëŠ”ì§€ ë¶ˆëª…í™•
- `details` ì—†ìŒ
- `targetId`, `targetName` ì—†ìŒ

---

## ðŸŽ¯ í™œë™ ë¡œê·¸ ìž‘ì„± ì›ì¹™

### 1. **ëª…í™•ì„±**
- ë¬´ì—‡ì´ ë³€ê²½ë˜ì—ˆëŠ”ì§€ ëª…í™•í•˜ê²Œ
- ë³€ê²½ ì „/í›„ ê°’ í¬í•¨

### 2. **ì™„ì „ì„±**
- ëª¨ë“  ê´€ë ¨ ì •ë³´ í¬í•¨
- `details` ê°ì²´ í™œìš©

### 3. **ì¼ê´€ì„±**
- ë™ì¼í•œ í˜•ì‹ ìœ ì§€
- ë™ì¼í•œ ìš©ì–´ ì‚¬ìš©

### 4. **ì¶”ì ì„±**
- `targetId`ë¡œ ëŒ€ìƒ ì¶”ì  ê°€ëŠ¥
- `timestamp`ë¡œ ì‹œê°„ ì¶”ì  ê°€ëŠ¥

---

## ðŸš¨ ì£¼ì˜ì‚¬í•­

### ì ˆëŒ€ ë¹ ëœ¨ë¦¬ë©´ ì•ˆ ë˜ëŠ” ê²ƒ

1. **ë°ì´í„° ë³€ê²½ ìž‘ì—…**: ëª¨ë“  CRUD ìž‘ì—…
2. **ì„¤ì • ë³€ê²½**: ëª¨ë“  ì„¤ì • ìˆ˜ì •
3. **íŒŒì¼ ì—…ë¡œë“œ/ì‚­ì œ**: ëª¨ë“  íŒŒì¼ ìž‘ì—…
4. **ì¤‘ìš”í•œ ì•¡ì…˜**: QR ìƒì„±/ì‚­ì œ ë“±

### ë¡œê·¸ ê¸°ë¡ ì‹œì 

- âœ… **ì„±ê³µ í›„**: ìž‘ì—…ì´ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œëœ í›„
- âœ… **ì‹¤íŒ¨ ì‹œ**: ì‹¤íŒ¨í•œ ê²½ìš°ì—ë„ ê¸°ë¡ (ì‹¤íŒ¨ ë¡œê·¸)
- âŒ **ìž‘ì—… ì „**: ìž‘ì—… ì „ì—ëŠ” ê¸°ë¡í•˜ì§€ ì•ŠìŒ

---

## ðŸ“ˆ í™œë™ ë¡œê·¸ í™œìš©

### 1. **ë””ë²„ê¹…**
```javascript
// íŠ¹ì • ê°€ê²Œì˜ ìµœê·¼ í™œë™ í™•ì¸
const logs = activityLogs.filter(log => log.targetId === storeId);
```

### 2. **í†µê³„**
```javascript
// ê°€ìž¥ ë§Žì´ ì‚¬ìš©ë˜ëŠ” ê¸°ëŠ¥
const actionCounts = {};
activityLogs.forEach(log => {
    actionCounts[log.action] = (actionCounts[log.action] || 0) + 1;
});
```

### 3. **ê°ì‚¬**
```javascript
// íŠ¹ì • ê¸°ê°„ì˜ ëª¨ë“  ë³€ê²½ ì‚¬í•­
const changes = activityLogs.filter(log => 
    new Date(log.timestamp) >= startDate && 
    new Date(log.timestamp) <= endDate
);
```

---

## ðŸŽ‰ ê²°ë¡ 

**í™œë™ ë¡œê·¸ëŠ” ì„ íƒì´ ì•„ë‹Œ í•„ìˆ˜ìž…ë‹ˆë‹¤!**

ëª¨ë“  ìƒˆë¡œìš´ ê¸°ëŠ¥ êµ¬í˜„ ì‹œ:
1. âœ… í™œë™ ë¡œê·¸ ê¸°ë¡ ì¶”ê°€
2. âœ… ë³€ê²½ ì „/í›„ ê°’ í¬í•¨
3. âœ… ìƒì„¸í•œ ì„¤ëª… ìž‘ì„±
4. âœ… `details` ê°ì²´ í™œìš©

**ì´ ì •ì±…ì„ ì¤€ìˆ˜í•˜ë©´ ì‹œìŠ¤í…œì˜ íˆ¬ëª…ì„±ê³¼ ì¶”ì ì„±ì´ í¬ê²Œ í–¥ìƒë©ë‹ˆë‹¤!**

---

**ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸**: 2025-10-26  
**ë‹¤ìŒ ì—…ë°ì´íŠ¸**: í™œë™ ë¡œê·¸ ë¶„ì„ ëŒ€ì‹œë³´ë“œ ì¶”ê°€ ì˜ˆì •

