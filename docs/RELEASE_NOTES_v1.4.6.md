# Release Notes v1.4.6

## 📅 릴리즈 정보
- **버전**: v1.4.6  
- **코드명**: "Multi Nexus"  
- **릴리즈 날짜**: 2025-11-12  
- **타입**: Minor Update

---

## 🎯 주요 하이라이트

1. **점주 다중 가게 연결 정식 지원** – 점주 검색 기반 연결 UI와 API 개선으로 한 계정이 여러 매장을 안전하게 관리
2. **대량 작업/내보내기 복원** – JSON·CSV 내보내기 및 일괄 일시정지/재개/삭제 API를 정비해 관리자 효율 향상
3. **기본 정보 QR 카드 고정 배치** – 도메인 상태와 QR 다운로드를 한 카드에서 안내하여 교육 없이도 즉시 활용

---

## ✨ 새로운 기능

### 1. 점주 다중 가게 연결 워크플로우
- 드롭다운 대신 **검색형 점주 선택 UI**를 도입해 이메일/전화로 빠르게 조회
- 동일 점주가 여러 매장에 연결되더라도 기존 매장 연결을 유지
- 대표 점주 전환은 `makePrimary` 옵션으로 명시적으로 실행하도록 분리

### 2. 가게 관리 통계 & 필터 연동
- 상단 통계 카드 클릭 시 상태/날짜 필터와 테이블이 즉시 동기화
- 승인 대기( pending )/일시정지/오늘 추가 필터를 한 번에 적용 가능

### 3. 대량 작업/내보내기 API 재구축
- `/api/stores/bulk-export`로 JSON·CSV 내보내기 복구 (UTF-8 BOM 적용)
- `/api/stores/bulk-import`로 JSON/CSV 기반 일괄 등록 지원
- `/api/stores/bulk-pause|bulk-resume|bulk-delete` API를 통해 대량 상태 변경 처리

### 4. 점주 QR 자가 발급
- 서브도메인이 준비된 점주는 기본 정보 화면에서 직접 QR을 최초 1회 생성 가능
- 재발급은 여전히 슈퍼어드민 권한으로 제한해 오남용을 방지

---

## 🔧 개선 사항

- DB 제약을 조정하여 점주-가게 다중 매핑 시 고유 제약 오류가 발생하지 않도록 정비
- `linkOwnerToStore()`가 역할(role)과 대표 지정(makePrimary)을 명시적으로 처리하도록 개선
- 기본 정보 섹션에 **QR 카드**를 새로 배치하고 상태 안내/다운로드 버튼을 일관되게 노출
- 도메인/QR 요약(상단 카드)와 기본 정보 QR 카드가 동일한 상태를 공유하도록 동기화

---

## 🐛 버그 수정

1. 점주를 다른 가게에 연결하면 기존 가게에서 해제되던 문제 해결  
2. 통계 카드 클릭 시 가게 목록이 갱신되지 않던 오류 수정  
3. JSON·CSV 내보내기/가져오기가 404 또는 빈 파일을 반환하던 현상 복구  
4. 점주-가게 연결 시 DB 권한(42501) 오류가 반복되던 이슈 제거

---

## ✅ 테스트

- 점주 검색 → 다수 가게 연결/해제 → 대표 지정 시나리오  
- 통계 카드 필터 클릭 → 상태/기간 필터 값 자동 반영 및 테이블 갱신  
- JSON/CSV 내보내기 및 CSV/JSON 가져오기 수동 검증  
- 기본 정보 섹션에서 QR 상태 전환(생성, 재발급, 다운로드) 확인  
- 기존 매장의 점주 리스트가 유지되는지 확인

---

## 🚀 배포 가이드

1. **API 서버 재시작**
    ```bash
    cd /Users/dohyeonkim/작업용/pickup
    npm run restart:api > server_runtime.log 2>&1 &
    ```
2. **브라우저 강제 새로고침**  
   `Cmd + Shift + R` (Mac) 또는 `Ctrl + Shift + R` (Windows/Linux)

---

## 🔮 다음 버전 (v1.4.7) 계획

1. 점주/가게 활동 로그 필터를 통합해 히스토리를 한 화면에서 추적  
2. QR 발급 이력과 사용 통계를 대시보드 카드로 시각화  
3. 점주 알림(이메일/SMS) 토글 및 템플릿 초안 제공

---

**v1.4.6 릴리즈 완료!** 🎉



