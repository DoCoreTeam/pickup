# 🔄 픽업 서비스 모노레포 마이그레이션 계획서

## 📋 개요

이 PR은 현재 Python HTTP 서버 + JSON 파일 기반의 픽업 서비스를 NestJS(백엔드) + Prisma + PostgreSQL, Next.js(프론트엔드/어드민) 기반 모노레포로 점진적으로 전환하는 상세 계획서와 분석 문서를 제공합니다.

## 🎯 목표

- **100% 호환성 유지**: 기존 API 엔드포인트, 응답 형식, 라우트 구조 완전 보존
- **점진적 마이그레이션**: 서비스 중단 없이 단계별 전환
- **성능 향상**: JSON 파일 → PostgreSQL, 동기 I/O → 비동기 처리
- **확장성 확보**: 모노레포 구조로 유지보수성 및 개발 효율성 향상

## 📁 추가된 문서

### 1. `/docs/plan.md` - 마이그레이션 계획서
- **4단계 마이그레이션 계획** (총 10주, 2.5개월)
- **현재 아키텍처 분석** (Python HTTP 서버, JSON 파일 기반)
- **목표 아키텍처 설계** (NestJS + Prisma + PostgreSQL, Next.js)
- **리스크 관리 및 롤백 전략**
- **테스트 전략** (단위/통합/E2E)
- **성능 개선 예상 효과** (응답 시간 90% 개선, 동시 처리 100배 향상)

### 2. `/docs/route-manifest.json` - API 라우트 매니페스트
- **모든 API 엔드포인트 완전 매핑** (GET, POST, PUT, DELETE, OPTIONS)
- **요청/응답 스키마 상세 정의**
- **쿼리 파라미터 및 경로 파라미터 명세**
- **의존 JSON 파일 경로 매핑**
- **CORS 설정 및 에러 처리 규칙**
- **성능 특성 및 캐싱 정보**

### 3. `/docs/env-keys.md` - 환경변수 키 목록
- **현재 시스템 환경변수** (OpenAI API, 서버 설정, 파일 경로)
- **마이그레이션 후 환경변수** (데이터베이스, NestJS, Next.js)
- **배포 환경별 설정** (Railway, Vercel, Supabase)
- **보안 고려사항 및 권장 설정**
- **마이그레이션 체크리스트**

### 4. `/docs/perf-audit.md` - 성능 감사 보고서
- **현재 시스템 성능 병목 분석**
  - 동기 파일 I/O 블로킹 (평균 응답 시간 500ms)
  - 캐싱 메커니즘의 한계 (5초 TTL)
  - 대용량 HTML 파일 (admin/dashboard.html 300KB)
- **마이그레이션 후 예상 개선 효과**
  - API 응답 시간: 500ms → 50ms (90% 개선)
  - 동시 처리: 10명 → 1000명 (100배 개선)
  - 페이지 로딩 시간: 3초 → 1초 (67% 개선)
- **성능 최적화 전략 및 모니터링 계획**

## 🔍 주요 분석 결과

### 현재 시스템 구조
- **백엔드**: Python 내장 HTTP 서버 (BaseHTTPRequestHandler)
- **데이터**: JSON 파일 기반 (`assets/data/*.json`)
- **프론트엔드**: 바닐라 HTML/CSS/JavaScript
- **배포**: Railway (Python 서버)

### 식별된 성능 병목
1. **동기 파일 I/O**: JSON 파일 읽기/쓰기로 인한 블로킹
2. **메모리 사용량**: 전체 데이터를 메모리에 로드
3. **확장성 제한**: 단일 서버로 인한 확장성 제약
4. **데이터 일관성**: 파일 락으로 인한 동시성 문제

### 마이그레이션 전략
- **Phase 1**: 인프라 구축 및 데이터베이스 설계 (2주)
- **Phase 2**: 데이터 마이그레이션 및 API 구현 (3주)
- **Phase 3**: 프론트엔드 마이그레이션 (3주)
- **Phase 4**: 배포 및 모니터링 (2주)

## 🛡️ 안전성 보장

### 100% 호환성 유지
- 기존 API 엔드포인트와 100% 동일한 인터페이스
- 응답 형식, 상태 코드, 헤더 완전 보존
- 쿼리 파라미터 및 요청 본문 구조 유지

### 점진적 전환
- A/B 테스트를 통한 병렬 운영
- 단계별 트래픽 이동
- 즉시 롤백 가능한 구조

### 철저한 테스트
- 단위 테스트 (커버리지 80% 이상)
- 통합 테스트 (모든 API 엔드포인트)
- E2E 테스트 (사용자 시나리오 전체)
- 성능 테스트 (부하/스트레스/내구성)

## 📊 예상 성과

### 기술적 개선
- **응답 시간**: 500ms → 50ms (90% 개선)
- **동시 처리**: 10명 → 1000명 (100배 개선)
- **메모리 사용량**: 50% 감소
- **가용성**: 95% → 99.9% (5%p 향상)

### 비즈니스 가치
- **사용자 경험**: 페이지 로딩 시간 67% 단축
- **관리자 효율성**: 작업 효율성 50% 향상
- **개발 생산성**: 배포 시간 50% 단축
- **시스템 안정성**: 에러율 90% 감소

## 🚀 다음 단계

이 계획서를 바탕으로 다음과 같은 단계별 실행이 가능합니다:

1. **Phase 1 시작**: 모노레포 구조 생성 및 데이터베이스 설계
2. **팀 리뷰**: 계획서 검토 및 피드백 수집
3. **리소스 할당**: 개발자 및 인프라 리소스 배정
4. **타임라인 조정**: 비즈니스 요구사항에 따른 일정 조정

## 📝 참고사항

- 이 PR은 **계획서만 포함**하며, 실제 코드 변경은 없습니다
- 기존 서비스의 동작과 응답 형식을 100% 유지합니다
- 모든 문서는 한국어로 작성되어 팀 내 이해도를 높였습니다
- 마이그레이션 과정에서 발생할 수 있는 리스크와 대응 방안을 상세히 기술했습니다

---

**이 계획서는 픽업 서비스의 미래를 위한 중요한 로드맵입니다. 팀의 검토와 피드백을 통해 더욱 완성도 높은 마이그레이션을 진행할 수 있을 것입니다.**
